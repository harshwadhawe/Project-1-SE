<div class="bg-gradient-to-br from-indigo-600 via-purple-600 to-blue-600 text-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24">
    <div class="text-center">
      <h1 class="text-5xl md:text-6xl font-bold mb-6">
        Build Your Dream PC
      </h1>
      <p class="text-xl md:text-2xl mb-8 text-indigo-100 max-w-3xl mx-auto">
        Create the perfect custom PC build with our intelligent component selection tool.
        Choose from thousands of parts, get compatibility checks, and share your builds with the community.
      </p>
      
      <div class="space-y-4 sm:space-y-0 sm:space-x-4 sm:flex sm:justify-center">
        <%= link_to new_build_path, 
              class: "inline-block bg-white text-indigo-600 font-bold text-lg px-8 py-4 rounded-lg hover:bg-indigo-50 transition-colors duration-200 shadow-lg transform hover:scale-105" do %>
          <i class="fas fa-rocket mr-2"></i>Start Building Now
        <% end %>
         
        <%# CORRECTED: The 'unless current_user' block around this link has been removed. %>
        <%= link_to parts_path, 
              class: "inline-block border-2 border-white text-white font-semibold text-lg px-8 py-4 rounded-lg hover:bg-white hover:text-indigo-600 transition-colors duration-200" do %>
          <i class="fas fa-list mr-2"></i>Browse Components
        <% end %>
      
      </div>
    </div>
  </div>
</div>

<% if current_user && @user_builds.present? %>
  <div class="py-10 bg-white border-t">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-900">
          Your current builds
        </h2>
        <div>
          <%= link_to builds_path,
                class: "inline-flex items-center bg-indigo-600 text-white text-sm font-semibold px-4 py-2 rounded hover:bg-indigo-700 transition-colors duration-200 shadow-sm" do %>
            <i class="fas fa-eye mr-2"></i> View All
          <% end %>
        </div>
      </div>


      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
        <% @user_builds.each do |build| %>
          <% parts_count = build.parts.size %>
          <% total_cost  = (build.respond_to?(:total_cost) ? build.total_cost : (build.try(:price_cents) || 0)).to_i %>
          <div class="bg-gray-50 rounded-lg p-5 border hover:shadow-md transition-shadow duration-200">
            <div class="flex items-start justify-between">
              <h3 class="text-lg font-semibold text-gray-900 truncate"><%= build.name %></h3>
              <% if build.shared? %>
                <span class="inline-flex items-center text-xs font-medium px-2 py-1 rounded bg-green-100 text-green-700">
                  <i class="fas fa-share-alt mr-1"></i> Shared
                </span>
              <% end %>
            </div>

            <p class="mt-1 text-sm text-gray-500">
              Updated <%= time_ago_in_words(build.updated_at) %> ago
            </p>

            <div class="mt-4 grid grid-cols-2 gap-3 text-sm">
              <div class="bg-white rounded border p-3">
                <p class="text-gray-500">Parts</p>
                <p class="mt-1 font-semibold tabular-nums"><%= parts_count %></p>
              </div>
              <div class="bg-white rounded border p-3">
                <p class="text-gray-500">Total Cost</p>
                <p class="mt-1 font-semibold tabular-nums">
                  <%# expects cents from total_cost helper %>
                  <%= number_to_currency(total_cost / 100.0) rescue "â€”" %>
                </p>
              </div>
            </div>

            <div class="mt-5 flex items-center justify-between">
              <%= link_to build_path(build), class: "text-indigo-600 text-sm font-medium hover:text-indigo-800" do %>
                <i class="fas fa-eye mr-1"></i> View
              <% end %>
              <div class="flex gap-3">
                <%= link_to edit_build_path(build), class: "text-sm text-gray-600 hover:text-gray-800" do %>
                  <i class="fas fa-edit mr-1"></i> Edit
                <% end %>
                <% if build.shared? %>
                  <%= link_to build.share_url(root_url.chomp("/")), class: "text-sm text-gray-600 hover:text-gray-800", target: "_blank", rel: "noopener" do %>
                    <i class="fas fa-link mr-1"></i> Share link
                  <% end %>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
<% elsif current_user %>
  <!-- Logged in but no builds yet -->
  <div class="py-10 bg-white border-t">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-2">You have no builds yet</h2>
      <p class="text-gray-600 mb-6">Start your first build in minutes.</p>
      <%= link_to new_build_path,
            class: "inline-block bg-indigo-600 text-white font-semibold px-6 py-3 rounded hover:bg-indigo-700" do %>
        <i class="fas fa-rocket mr-2"></i> Create your first build
      <% end %>
    </div>
  </div>
<% end %>


<div class="py-16 bg-gray-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-16">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
        Why Choose Our PC Builder?
      </h2>
      <p class="text-xl text-gray-600 max-w-2xl mx-auto">
        Whether you're a gaming enthusiast, content creator, or professional, we've got the tools to help you build the perfect PC.
      </p>
    </div>

    <div class="grid md:grid-cols-3 gap-8">
      <div class="text-center p-6">
        <div class="bg-indigo-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="fas fa-tools text-2xl text-indigo-600"></i>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-3">Easy Component Selection</h3>
        <p class="text-gray-600">
          Browse through our extensive catalog of CPUs, GPUs, motherboards, and more. 
          No login required to start building your dream PC.
        </p>
      </div>

      <div class="text-center p-6">
        <div class="bg-green-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="fas fa-check-circle text-2xl text-green-600"></i>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-3">Compatibility Checking</h3>
        <p class="text-gray-600">
          Our smart system ensures all your 
          components work together perfectly. 
          No more compatibility headaches or costly mistakes.
        </p>
      </div>

      <div class="text-center p-6">
        <div class="bg-purple-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="fas fa-share-alt text-2xl text-purple-600"></i>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-3">Share & Save Builds</h3>
        <p class="text-gray-600">
          <% if current_user %>
            Save your builds and share them with friends using our easy sharing feature.
          <% else %>
            Login to save your builds and share them with friends using our easy sharing feature.
          <% end %>
        </p>
      </div>
    </div>
  </div>
</div>

<div class="py-16 bg-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold text-gray-900 mb-4">
        Featured Components
      </h2>
      <p class="text-lg text-gray-600">
        Explore our premium selection of PC components from top brands
      </p>
    </div>

    <div class="grid md:grid-cols-4 gap-6">
      <% @categories.each do |name, klass| %>
        <div class="bg-gray-50 rounded-lg p-6 hover:shadow-lg transition-shadow duration-200">
          <div class="text-center">
            <div class="text-3xl mb-3">
              <i class="
              <% case name
                 when "Cpu" %>fas fa-microchip text-indigo-600
               <% when "GPU" %>fas fa-gamepad text-green-600
              <% when "Motherboard" %>fas fa-bolt text-yellow-600
              <% when "Memory" %>fas fa-brain text-purple-600
              <% when "Storage" %>fas fa-hdd text-blue-600
              <% when "Cooler" %>fas fa-snowflake text-cyan-600
              <% when "PcCase" %>fas fa-cube text-gray-600
              <% when "PSU" %>fas fa-plug text-red-600
              <% end %>"></i>
            </div>
            <h3 class="font-semibold text-gray-900 mb-2"><%= name == "PcCase" ? "Cases" : name.pluralize %></h3>
            
            <% if @sample_parts[name].any? %>
              <p class="text-sm text-gray-600 mb-3">
                <%= @sample_parts[name].count %> featured <%= name.downcase %><%= @sample_parts[name].count != 1 ? 's' : '' %>
              </p>
              
              <div class="space-y-1 mb-4">
                <% @sample_parts[name].limit(2).each do |part| %>
                  <p class="text-xs text-gray-500 truncate">
                    <%= "#{part.brand} #{part.name}".truncate(25) %>
                  </p>
                <% end %>
              </div>
            <% end %>
            
            <% 
              case name
              when "PcCase"
                view_path = pc_cases_path
              when "GPU"
                view_path = gpus_path
              when "PSU"
                view_path = psus_path
              else
                view_path = send("#{name.downcase.pluralize}_path")
              end
            %>
            <%= link_to "Browse All", view_path, 
                  class: "inline-block bg-indigo-600 text-white px-4 py-2 rounded text-sm hover:bg-indigo-700 transition-colors duration-200" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<div class="bg-indigo-600 text-white py-16">
  <div class="max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8">
    <h2 class="text-3xl md:text-4xl font-bold mb-4">
      Ready to Build Your PC?
    </h2>
    <p class="text-xl text-indigo-100 mb-8">
      <% if current_user %>
        Welcome back, <%= current_user.name %>!
        Continue building your perfect PC setup.
      <% else %>
        Join thousands of PC builders who trust our platform for their custom builds.
      <% end %>
    </p>
    
    <div class="space-y-4 sm:space-y-0 sm:space-x-4 sm:flex sm:justify-center">
      <%= link_to builds_path, 
            class: "inline-block bg-white text-indigo-600 font-bold text-lg px-8 py-4 rounded-lg hover:bg-indigo-50 transition-colors duration-200 shadow-lg" do %>
        <i class="fas fa-rocket mr-2"></i>Start Building
      <% end %>
      
      <% unless current_user %>
        <%= link_to signup_path, 
              class: "inline-block border-2 border-white text-white font-semibold text-lg px-8 py-4 rounded-lg hover:bg-white hover:text-indigo-600 transition-colors duration-200" do %>
          <i class="fas fa-user-plus mr-2"></i>Sign Up Free
        <% end %>
      <% end %>
    </div>
  </div>
</div>